(self.webpackChunkpebula=self.webpackChunkpebula||[]).push([[6614],{66614:(t,e,n)=>{"use strict";n.d(e,{P:()=>_});var r=n(23191),i=n(61511),o=n(43691),s=n(15980),c=n(8055),a=n(66283),u=n(26756),l=n(7997),m=n(64914),d=n(44522),h=n(31572);const g=["mat-header-context-menu-trigger",""],p={hasBackdrop:!0,xPos:"after",yPos:"below"};let f=(()=>{class t{constructor(t,e){this.plugin=t,this.elRef=e}openOverlayPanel(){this.plugin.overlayPanel.open(this.plugin.style,this.elRef,this.plugin.config||p,this.context)}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(r.Z),h.Y36(h.SBq))},t.\u0275cmp=h.Xpm({type:t,selectors:[["div","mat-header-context-menu-trigger",""]],hostAttrs:[1,"mat-header-context-menu-trigger"],hostBindings:function(t,e){1&t&&h.NdJ("click",function(){return e.openOverlayPanel()})},attrs:g,decls:2,vars:0,consts:[[2,"height","16px","width","16px","font-size","16px","line-height","16px"]],template:function(t,e){1&t&&(h.TgZ(0,"mat-icon",0),h._uU(1,"more_vert"),h.qZA())},directives:[o.Hw],styles:["div.mat-header-context-menu-trigger{position:absolute;display:flex;align-items:center;right:0;height:100%;cursor:pointer;margin-right:12px;z-index:#100}[dir=rtl] div.mat-header-context-menu-trigger{right:unset;left:0;margin-right:unset;margin-left:12px}"],encapsulation:2}),t})();class v extends m.id{constructor(t){super(),this.cfr=t,this.name="matHeaderContextMenuTrigger",this.kind="dataHeaderExtensions",this.projectContent=!1}shouldRender(t){return!!t.injector.get(r.Z,!1)}getFactory(t){return this.cfr.resolveComponentFactory(f)}onCreated(t,e){e.instance.context=t,e.changeDetectorRef.markForCheck()}}const y=["columnMenu"],b=["menuViewLocation"];function Z(t,e){if(1&t&&(h.TgZ(0,"button",3),h.TgZ(1,"mat-icon"),h._uU(2,"sort"),h.qZA(),h._uU(3,"Sort "),h.qZA()),2&t){h.oxw();const t=h.MAs(16);h.Q6J("matMenuTriggerFor",t)}}let x=(()=>{class t{constructor(t){this.ref=t,this.currentFilter="",this.column=t.data.col,this.grid=t.data.grid,this.grid.ds.sort.column===this.column&&(this.currentSort=this.grid.ds.sort.sort.order),this.currentPin=this.column.columnDef.sticky?"start":this.column.columnDef.stickyEnd?"end":void 0;const e=this.grid.ds.filter;e&&"value"===e.type&&e.columns&&e.columns.indexOf(this.column)>=0&&(this.currentFilter=e.filter)}ngAfterViewInit(){this.matMenu.closed.subscribe(t=>{this.ref.close()});const t=this.menuViewLocation.createEmbeddedView(this.matMenu.templateRef);this.matMenu.setElevation(0),this.matMenu.focusFirstItem("program"),this.matMenu._resetAnimation(),t.markForCheck(),t.detectChanges(),this.matMenu._startAnimation()}hide(){this.grid.columnApi.hideColumns(this.column.id)}onSortToggle(t){this.currentSort===t?this.grid.ds.setSort():this.grid.ds.setSort(this.column,{order:t})}onPinToggle(t){this.currentPin===t?this.column.columnDef.updatePin():this.column.columnDef.updatePin(t)}filterColumn(t){this.currentFilter=t,t?this.grid.setFilter(t.trim(),[this.column]):this.grid.setFilter()}clickTrap(t){t.preventDefault(),t.stopPropagation()}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(d.Mr))},t.\u0275cmp=h.Xpm({type:t,selectors:[["mat-excel-style-header-menu"]],viewQuery:function(t,e){if(1&t&&(h.Gf(y,7,c.VK),h.Gf(b,7,h.s_b)),2&t){let t;h.iGM(t=h.CRH())&&(e.matMenu=t.first),h.iGM(t=h.CRH())&&(e.menuViewLocation=t.first)}},decls:48,vars:15,consts:[[1,"pbl-mat-menu-panel"],["columnMenu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["sortMenu","matMenu"],[3,"color"],["pinMenu","matMenu"],[1,"mat-menu-item","pbl-mat-menu-row",3,"click"],["matInput","",3,"value","keyup"],["input",""],["matPrefix",""],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["menuViewLocation",""]],template:function(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"mat-menu",0,1),h.YNc(2,Z,4,1,"button",2),h.TgZ(3,"button",3),h.TgZ(4,"mat-icon"),h._uU(5,"place"),h.qZA(),h._uU(6,"Pin "),h.qZA(),h.TgZ(7,"button",4),h.NdJ("click",function(){return e.grid.columnApi.autoSizeColumn(e.column)}),h.TgZ(8,"mat-icon"),h._uU(9,"keyboard_tab"),h.qZA(),h._uU(10,"Auto Fit "),h.qZA(),h.TgZ(11,"button",4),h.NdJ("click",function(){return e.hide()}),h.TgZ(12,"mat-icon"),h._uU(13,"visibility_off"),h.qZA(),h._uU(14,"Hide Column "),h.qZA(),h.TgZ(15,"mat-menu",null,5),h.TgZ(17,"button",4),h.NdJ("click",function(){return e.onSortToggle("asc")}),h.TgZ(18,"mat-icon",6),h._uU(19,"arrow_upward"),h.qZA(),h.TgZ(20,"span"),h._uU(21,"Ascending"),h.qZA(),h.qZA(),h.TgZ(22,"button",4),h.NdJ("click",function(){return e.onSortToggle("desc")}),h.TgZ(23,"mat-icon",6),h._uU(24,"arrow_downward"),h.qZA(),h.TgZ(25,"span"),h._uU(26,"Descending"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(27,"mat-menu",null,7),h.TgZ(29,"button",4),h.NdJ("click",function(){return e.onPinToggle("start")}),h.TgZ(30,"span"),h._uU(31,"Start"),h.qZA(),h.qZA(),h.TgZ(32,"button",4),h.NdJ("click",function(){return e.onPinToggle("end")}),h.TgZ(33,"span"),h._uU(34,"End"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(35,"div",8),h.NdJ("click",function(t){return e.clickTrap(t)}),h.TgZ(36,"mat-form-field"),h.TgZ(37,"mat-label"),h._uU(38,"Search"),h.qZA(),h.TgZ(39,"input",9,10),h.NdJ("keyup",function(){h.CHM(t);const n=h.MAs(40);return e.filterColumn(n.value)}),h.qZA(),h.TgZ(41,"mat-icon",11),h._uU(42,"search"),h.qZA(),h.TgZ(43,"button",12),h.NdJ("click",function(){return e.filterColumn("")}),h.TgZ(44,"mat-icon"),h._uU(45,"close"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.GkF(46,null,13)}if(2&t){const t=h.MAs(28);h.xp6(2),h.Q6J("ngIf",e.column.sort),h.xp6(1),h.Q6J("matMenuTriggerFor",t),h.xp6(14),h.ekj("menu-item-selected","asc"===e.currentSort),h.xp6(1),h.Q6J("color","asc"===e.currentSort?"primary":""),h.xp6(4),h.ekj("menu-item-selected","desc"===e.currentSort),h.xp6(1),h.Q6J("color","desc"===e.currentSort?"primary":""),h.xp6(6),h.ekj("menu-item-selected","start"===e.currentPin),h.xp6(3),h.ekj("menu-item-selected","end"===e.currentPin),h.xp6(7),h.Q6J("value",e.currentFilter),h.xp6(4),h.Udp("visibility",e.currentFilter?"visible":"hidden")}},directives:[c.VK,i.O5,c.OP,c.p6,o.Hw,a.KE,a.hX,u.Nt,a.qo,s.lW,a.R9],styles:[".mat-menu-panel.pbl-mat-menu-panel{max-width:400px}.mat-menu-item.pbl-mat-menu-row{width:100%;box-sizing:border-box;line-height:inherit;height:auto;margin:6px 0;cursor:inherit}.mat-menu-item.pbl-mat-menu-row:hover{background:inherit}"],encapsulation:2}),t})(),_=(()=>{class t{constructor(t,e,n,r){t||(e.addMulti("dataHeaderExtensions",new v(n)),e.addMulti("overlayPanels",new d.hZ("excelMenu",x,n)))}}return t.NGRID_PLUGIN=(0,m.Ic)({id:r.d},r.Z),t.\u0275fac=function(e){return new(e||t)(h.LFG(t,12),h.LFG(m.B6),h.LFG(h._Vd),h.LFG(l.f8))},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[i.ez,o.Ps,s.ot,c.Tx,a.lN,u.c,m.dC,d.N1]]}),t})()},23191:(t,e,n)=>{"use strict";n.d(e,{d:()=>s,Z:()=>c});var r=n(64914),i=n(44522),o=n(31572);const s="matHeaderContextMenu";let c=(()=>{class t{constructor(t,e){this.pluginCtrl=e,this.overlayPanel=t.create(e.extApi.grid)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(i.Yp),o.Y36(r.q5))},t.\u0275dir=o.lG2({type:t,selectors:[["pbl-ngrid","matHeaderContextMenu",""]],inputs:{style:["matHeaderContextMenu","style"],config:"config"},features:[o._Bn([i.Yp])]}),t})()},44522:(t,e,n)=>{"use strict";n.d(e,{hZ:()=>i,Yp:()=>h,N1:()=>v,Mr:()=>a});var r=n(64914);class i extends r.id{constructor(t,e,n,r){super(),this.component=e,this.cfr=n,this.injector=r,this.kind="overlayPanels",this.projectContent=!1,this.name=t}getFactory(t){return this.cfr.resolveComponentFactory(this.component)}onCreated(t,e){e.changeDetectorRef.markForCheck(),e.changeDetectorRef.detectChanges()}}var o=n(55959),s=n(31906),c=n(25416);class a{constructor(t,e){this.overlayRef=t,this.data=e,this._closed$=new o.xQ,this.closed=this._closed$.asObservable(),this._closingActions(this,t).pipe((0,c.R)(this.closed)).subscribe(()=>this.close())}close(){if(this._closed$){const t=this._closed$;this._closed$=void 0,t.next(),t.complete(),this.overlayRef.detach(),this.overlayRef.dispose()}}_closingActions(t,e){const n=e.backdropClick(),r=e.detachments();return(0,s.T)(n,r,t.closed)}}var u=n(31572),l=n(2522),m=n(26899);const d={hasBackdrop:!1,xPos:"center",yPos:"center",insetPos:!1};let h=(()=>{class t{constructor(t,e){this._overlay=t,this.zone=e}create(t){return new g(this._overlay,this.zone,t)}}return t.\u0275fac=function(e){return new(e||t)(u.LFG(l.aV),u.LFG(u.R0b))},t.\u0275prov=u.Yz7({token:t,factory:t.\u0275fac}),t})();class g{constructor(t,e,n){this._overlay=t,this.zone=e,this.grid=n;const i=r.q5.find(n);this.injector=i.injector,this.vcRef=i.injector.get(u.s_b),this._scrollStrategy=()=>t.scrollStrategies.reposition()}openGridCell(t,e,n,r,i){const o=this.grid.columnApi.findColumn(e);if(!o)return;let s,c=0;switch(n){case"header":case"footer":s=n;break;default:"number"==typeof n&&(s="table",c=n)}if(!s)return;const a=o&&o.columnDef.queryCellElements(s)[c];return a?this.open(t,new u.SBq(a),r,i):void 0}open(t,e,n,i){n=Object.assign(Object.assign({},d),n||{});const o=this.findNamesExtension(t);if(o)return this.zone.run(()=>{const t=this._createOverlay(e,n),s=new a(t,i);if(this._setPosition(t.getConfig().positionStrategy,n),o instanceof r.Te){const e=this._getTemplatePortal(o.tRef,s),n=t.attach(e);n.markForCheck(),n.detectChanges()}else{const e=this._getComponentPortal(s,o),n=t.attach(e);o.onCreated(null,n)}return t.updatePosition(),s})}_createOverlay(t,e){const n=this._getOverlayConfig(t,e),r=this._overlay.create(n);return r.getConfig().hasBackdrop=!!e.hasBackdrop,r.keydownEvents().subscribe(),r}_getOverlayConfig(t,e){const n=this._overlay.position().flexibleConnectedTo(t).withLockedPosition();return new l.X_({positionStrategy:n,backdropClass:e.backdropClass||"cdk-overlay-transparent-backdrop",scrollStrategy:this._scrollStrategy(),direction:this.grid.dir})}_getTemplatePortal(t,e){return new m.UE(t,this.vcRef,{grid:this.grid,ref:e})}_getComponentPortal(t,e){const n=u.zs3.create({providers:[{provide:a,useValue:t}],parent:e.injector||this.injector});return new m.C5(e.component,this.vcRef,n,e.cfr||null)}_setPosition(t,e){let[n,r]="center"===e.xPos?["center","center"]:"before"===e.xPos?["end","start"]:["start","end"],[i,o]="center"===e.yPos?["center","center"]:"above"===e.yPos?["bottom","top"]:["top","bottom"],[s,c]=[i,o],[a,u]=[n,r];e.insetPos||("center"!==i&&(s="top"===i?"bottom":"top"),"center"!==o&&(c="top"===o?"bottom":"top")),t.withPositions([{originX:n,originY:s,overlayX:a,overlayY:i,offsetY:0},{originX:r,originY:s,overlayX:u,overlayY:i,offsetY:0},{originX:n,originY:c,overlayX:a,overlayY:o,offsetY:-0},{originX:r,originY:c,overlayX:u,overlayY:o,offsetY:-0}])}findNamesExtension(t){let e;return this.grid.registry.forMulti("overlayPanels",n=>{for(const r of n)if(r.name===t)return e=r,!0}),e}}n(79062);var p=n(61511),f=n(22526);let v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({providers:[h],imports:[[p.ez,l.U8,f.vT]]}),t})()},79062:(t,e,n)=>{"use strict";n.d(e,{s:()=>o});var r=n(64914),i=n(31572);let o=(()=>{class t extends r.Te{constructor(t,e){super(t,e),this.kind="overlayPanels"}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.Rgc),i.Y36(r.B6))},t.\u0275dir=i.lG2({type:t,selectors:[["","pblNgridOverlayPanelDef",""]],inputs:{name:["pblNgridOverlayPanelDef","name"]},features:[i.qOj]}),t})()}}]);